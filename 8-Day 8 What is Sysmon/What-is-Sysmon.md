# üß† Day 8 ‚Äî Sysmon: Enhancing Endpoint Visibility for SOC Analysts

Welcome to **Day 8** of the **30-Day MyDFIR for SOC Analyst Challenge**!  
In today‚Äôs session, we‚Äôll explore **Sysmon (System Monitor)** ‚Äî one of the most powerful tools available for improving visibility into Windows endpoints.

---

## üéØ Objective

By the end of this documentation, you will:
- Understand **what Sysmon is** and **why it‚Äôs essential** for SOC analysts.  
- Learn about **key event IDs** generated by Sysmon.  
- Discover how Sysmon helps detect malicious activity during investigations.

---

## üß© Why Endpoint Visibility Matters

Having rich visibility into your endpoints is **critical** for effective incident detection and investigation.  
Without proper logging and visibility, analysts may struggle to determine **what exactly happened on an endpoint** during a potential compromise.

- ‚úÖ **Good news:** Windows logging is **enabled by default**.  
- ‚ùå **Bad news:** Default settings **aren‚Äôt sufficient**, as they miss key events such as **process creation**, **network connections**, and **image loads**.

To enhance visibility, analysts can:
1. Manually configure **Windows auditing policies**, or  
2. Install **Sysmon**, which provides far deeper and more structured telemetry.

---

## ‚öôÔ∏è What Is Sysmon?

**Sysmon (System Monitor)** is a **free tool from Microsoft**, part of the **Sysinternals Suite**.  
It extends Windows logging by monitoring and recording detailed system activity, providing analysts with valuable telemetry for threat detection and forensic analysis.

### üîç Key Features
- **Tracks process creation** and includes **command-line arguments**.  
- **Logs file hashes** for integrity verification and threat intelligence lookups.  
- **Captures network connections**, showing **source/destination IPs** and **ports**.  
- **Supports configuration files** for fine-tuning which events are logged.  

As of the latest release (**version 15.15**), Sysmon supports **30 different Event IDs** ‚Äî giving analysts rich data to detect suspicious behavior.

---

## üß† Why Sysmon Is Valuable

Sysmon allows analysts to:
- Correlate **processes**, **threads**, and **network activity**.  
- Detect **malware execution**, **lateral movement**, **command and control (C2)** connections, and **credential dumping attempts**.  
- Improve **situational awareness** of endpoint behavior.

A key field provided by Sysmon is the **Process GUID (Globally Unique Identifier)**, which allows correlation of multiple related events.  
Using this, analysts can connect the dots between **process creation**, **network communication**, and **file access** ‚Äî forming a complete attack chain.

---

## üåê Network Connection Monitoring

Sysmon can log **network connections** including:
- Source and destination **IP addresses**
- Source and destination **ports**
- The **process** responsible for the connection

üí° *Example:*  
If a C2 process establishes an outbound connection to a suspicious external IP on a non-standard port, you can:
1. Identify the responsible process.  
2. Correlate it using the **Process GUID**.  
3. Trace it back to its **parent process** or **file hash**.

‚ö†Ô∏è **Note:** Network connection logging is **disabled by default**. You must enable it through the **Sysmon configuration file**.

---

## üßæ Important Sysmon Event IDs

Sysmon logs 30+ event types, but here are some of the most **valuable for investigations**:

### üü¢ Event ID 1 ‚Äî Process Creation
Tracks all **newly created processes**, including:
- Executable name and **command-line arguments**
- **Parent process**
- **File hash**

This event helps detect when malware is executed and provides full command-line visibility.

---

### üîµ Event ID 3 ‚Äî Network Connection
Logs **network connections** initiated by processes.

- Tracks **source/destination IPs** and **ports**  
- Maps connections to the **responsible process**  
- Useful for identifying **suspicious outbound traffic**

> üß© *Recommendation:* Enable Event ID 3 in your Sysmon configuration to capture valuable network telemetry.

---

### üü£ Event IDs 6, 7, 8 ‚Äî Driver Load, Image Load, Create Remote Thread
These events can reveal **defense evasion** or **process injection** techniques, where attackers inject malicious code into legitimate processes.

- **Event ID 6:** Driver Load  
- **Event ID 7:** Image Load *(disabled by default)*  
- **Event ID 8:** Create Remote Thread  

While these events can be **noisy** (many false positives), correlating them via **Process GUIDs** helps isolate suspicious behavior.

---

### üü† Event ID 10 ‚Äî Process Access
Logs attempts by one process to **access another process‚Äôs memory** ‚Äî often seen in **credential theft** attempts.

Attackers frequently target:
- **`lsass.exe` (Local Security Authority Subsystem Service)**  
  ‚Üí Because it stores **user credentials** and tokens.

Monitoring Event ID 10 is crucial for detecting tools like **Mimikatz** or **credential dumpers**.

---

### üî¥ Event ID 22 ‚Äî DNS Query
Records **DNS lookups** performed by processes ‚Äî extremely valuable for **threat hunting**.

- Reveals domains that endpoints are querying.  
- Can detect suspicious **DGA (Domain Generation Algorithm)** domains used by malware.  

> üí° *Real-world insight:*  
> Analysts have identified compromised endpoints by detecting random, algorithmically generated domains under Event ID 22.

---

## üß© Correlating Events

The **Process GUID** is your best friend when using Sysmon.  
By correlating multiple events (e.g., Event ID 1 ‚Üí 3 ‚Üí 22), you can:
- Trace the **origin of attacks**  
- Identify **malicious network connections**  
- Reconstruct **attack timelines**

---

## üîó Resources

- [Sysinternals Sysmon Official Page](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon)  
- [SwiftOnSecurity Sysmon Configuration](https://github.com/SwiftOnSecurity/sysmon-config)  
- [Microsoft Sysmon Event ID Reference](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon#sysmon-event-ids)

---

## üèÅ Conclusion

Sysmon is a **must-have tool** for any SOC analyst.  
It provides deep insight into process, file, and network activity ‚Äî enabling effective detection and investigation of threats.

‚úÖ **Key Takeaways**
- Default Windows logging is not enough.  
- Sysmon extends visibility with rich, structured telemetry.  
- Use configuration files to optimize logging and reduce noise.  
- Correlate events via **Process GUIDs** for powerful analysis.  

---
